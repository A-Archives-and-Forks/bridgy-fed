{% extends "base.html" %}

{% block title %}{{ id }} - Bridgy Fed{% endblock %}

{% block content %}

{% if g.user.LABEL == 'web' %}
{% if g.user.has_redirects == False %}
<div class="row promo warning">
<form method="post" action="/web-site">
  Next step:
  <a href="/docs#redirect+these+URL+paths">
    add the .well-known redirects.
  </a>
  <input type="hidden" name="url" value="{{ g.user.web_url() }}" />
  <input type="submit" class="btn btn-default" value="Check now" />
</form>

{% if g.user.redirects_error %}
<details class="small">
  {{ g.user.redirects_error|safe }}
</details>
{% endif %}
</div>
{% endif %}

{% if g.user.has_hcard == False %}
<div class="row promo warning">
<form method="post" action="/web-site">
  Next step: <a href="/docs#profile">add a representative h-card.</a>
  <input type="hidden" name="url" value="{{ g.user.web_url() }}" />
  <input type="submit" class="btn btn-default" value="Check now" />
</form>
</div>
{% endif %}
{% endif %}

{% include "user_addresses.html" %}

<div class="row">
    <a href="{{ g.user.user_page_path('followers') }}">{{ followers }} follower{% if followers != '1' %}s{% endif %}</a>
  &middot; <a href="{{ g.user.user_page_path('following') }}">following {{ following }}</a>
  &middot; <a href="{{ g.user.user_page_path('feed') }}">HTML</a>
  &middot; <a href="{{ g.user.user_page_path('feed?format=atom') }}">Atom</a>
  &middot; <a href="{{ g.user.user_page_path('feed?format=rss') }}">RSS</a>
  &middot; <a href="/.well-known/webfinger?resource=acct:{{ g.user.ap_address() }}">Webfinger</a>
  &middot; <a href="{{ g.user.ap_actor() }}">ActivityPub</a>
</div>

{% if g.user.LABEL != 'activitypub' %}
<div class="row">
<form method="post" action="/remote-follow">
<p>
 <label for="follow-address">Follow @{{ id }} with your fediverse address:</label>
 <input id="follow-address" name="address" type="text" required
        placeholder="@user@domain.social" alt="fediverse address"
        value="{{ follow_url or '' }}"></input>
 <input name="domain" type="hidden" value="{{ id }}"></input>
 <input name="protocol" type="hidden" value="{{ g.user.LABEL }}"></input>
 <button type="submit" class="btn btn-default">Follow</button>
</p>
</form>
</div>
{% endif %}

{% include "activities.html" %}

{% endblock %}
